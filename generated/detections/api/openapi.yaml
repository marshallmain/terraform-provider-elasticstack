openapi: 3.0.3
info:
  description: You can create rules that automatically turn events and external alerts
    sent to Elastic Security into detection alerts. These alerts are displayed on
    the Detections page.
  title: Security Detections (Elastic Cloud and self-hosted)
  version: 2023-10-31
servers:
- url: "http://{kibana_host}:{port}"
  variables:
    kibana_host:
      default: localhost
    port:
      default: "5601"
security:
- basicAuth: []
- apiKeyAuth: []
tags:
- description: You can create rules that automatically turn events and external alerts
    sent to Elastic Security into detection alerts. These alerts are displayed on
    the Detections page.
  name: Security Detections
paths:
  /s/{spaceId}/api/detection_engine/rules:
    delete:
      description: Delete a detection rule using the `rule_id` or `id` field.
      operationId: DeleteRule
      parameters:
      - explode: false
        in: path
        name: spaceId
        required: true
        schema:
          type: string
        style: simple
      - description: The rule's `id` value.
        explode: true
        in: query
        name: id
        required: false
        schema:
          $ref: '#/components/schemas/RuleObjectId'
        style: form
      - description: The rule's `rule_id` value.
        explode: true
        in: query
        name: rule_id
        required: false
        schema:
          $ref: '#/components/schemas/RuleSignatureId'
        style: form
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RuleResponse'
          description: Indicates a successful call.
      summary: Delete a detection rule
      tags:
      - Security Detections
    get:
      description: Retrieve a detection rule using the `rule_id` or `id` field.
      operationId: ReadRule
      parameters:
      - explode: false
        in: path
        name: spaceId
        required: true
        schema:
          type: string
        style: simple
      - description: The rule's `id` value.
        explode: true
        in: query
        name: id
        required: false
        schema:
          $ref: '#/components/schemas/RuleObjectId'
        style: form
      - description: The rule's `rule_id` value.
        explode: true
        in: query
        name: rule_id
        required: false
        schema:
          $ref: '#/components/schemas/RuleSignatureId'
        style: form
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RuleResponse'
          description: Indicates a successful call.
      summary: Retrieve a detection rule
      tags:
      - Security Detections
    patch:
      description: Update specific fields of an existing detection rule using the
        `rule_id` or `id` field.
      operationId: PatchRule
      parameters:
      - explode: false
        in: path
        name: spaceId
        required: true
        schema:
          type: string
        style: simple
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RulePatchProps'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RuleResponse'
          description: Indicates a successful call.
      summary: Patch a detection rule
      tags:
      - Security Detections
    post:
      description: Create a new detection rule.
      operationId: CreateRule
      parameters:
      - explode: false
        in: path
        name: spaceId
        required: true
        schema:
          type: string
        style: simple
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RuleCreateProps'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RuleResponse'
          description: Indicates a successful call.
      summary: Create a detection rule
      tags:
      - Security Detections
    put:
      description: |
        Update a detection rule using the `rule_id` or `id` field. The original rule is replaced, and all unspecified fields are deleted.
        > info
        > You cannot modify the `id` or `rule_id` values.
      operationId: UpdateRule
      parameters:
      - explode: false
        in: path
        name: spaceId
        required: true
        schema:
          type: string
        style: simple
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RuleUpdateProps'
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RuleResponse'
          description: Indicates a successful call.
      summary: Update a detection rule
      tags:
      - Security Detections
  /api/detection_engine/rules/_bulk_action:
    get:
      description: List all unique tags from all detection rules.
      operationId: ReadTags
      parameters:
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RuleTagArray'
          description: Indicates a successful call
      summary: List all detection rule tags
      tags:
      - Security Detections
    patch:
      deprecated: true
      description: Update specific fields of existing detection rules using the `rule_id`
        or `id` field.
      operationId: BulkPatchRules
      parameters:
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              items:
                $ref: '#/components/schemas/RulePatchProps'
              type: array
        description: "A JSON array of rules, where each rule contains the required\
          \ fields."
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkCrudRulesResponse'
          description: Indicates a successful call.
      summary: Patch multiple detection rules
      tags:
      - Security Detections
    put:
      deprecated: true
      description: |
        Update multiple detection rules using the `rule_id` or `id` field. The original rules are replaced, and all unspecified fields are deleted.
        > info
        > You cannot modify the `id` or `rule_id` values.
      operationId: BulkUpdateRules
      parameters:
      - description: Cross-site request forgery protection
        explode: false
        in: header
        name: kbn-xsrf
        required: true
        schema:
          type: string
        style: simple
      - description: Api version
        explode: false
        in: header
        name: elastic-api-version
        required: false
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              items:
                $ref: '#/components/schemas/RuleUpdateProps'
              type: array
        description: A JSON array where each element includes the `id` or `rule_id`
          field of the rule you want to update and the fields you want to modify.
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkCrudRulesResponse'
          description: Indicates a successful call.
      summary: Update multiple detection rules
      tags:
      - Security Detections
components:
  schemas:
    AlertsIndex:
      deprecated: true
      description: (deprecated) Has no effect.
      type: string
    AlertsIndexNamespace:
      description: Has no effect.
      type: string
    AlertStatus:
      enum:
      - open
      - closed
      - acknowledged
      - in-progress
      type: string
    AlertSuppression:
      properties:
        duration:
          $ref: '#/components/schemas/AlertSuppressionDuration'
        group_by:
          items:
            type: string
          maxItems: 3
          minItems: 1
          type: array
        missing_fields_strategy:
          $ref: '#/components/schemas/AlertSuppressionMissingFieldsStrategy'
      required:
      - group_by
      type: object
    AlertSuppressionDuration:
      properties:
        unit:
          enum:
          - s
          - m
          - h
          type: string
        value:
          minimum: 1
          type: integer
      required:
      - unit
      - value
      type: object
    AlertSuppressionGroupBy:
      items:
        type: string
      maxItems: 3
      minItems: 1
      type: array
    AlertSuppressionMissingFieldsStrategy:
      description: |-
        Describes how alerts will be generated for documents with missing suppress by fields:
        doNotSuppress - per each document a separate alert will be created
        suppress - only alert will be created per suppress by bucket
      enum:
      - doNotSuppress
      - suppress
      type: string
    AlertTag:
      $ref: '#/components/schemas/NonEmptyString'
    AlertTags:
      items:
        $ref: '#/components/schemas/AlertTag'
      type: array
    AlertVersion:
      properties:
        count:
          type: integer
        version:
          type: integer
      required:
      - count
      - version
      type: object
    AnomalyThreshold:
      description: Anomaly threshold
      minimum: 0
      type: integer
    BuildingBlockType:
      description: "Determines if the rule acts as a building block. By default, building-block\
        \ alerts are not displayed in the UI. These rules are used as a foundation\
        \ for other rules that do generate alerts. Its value must be default."
      type: string
    BulkActionEditPayload:
      anyOf:
      - $ref: '#/components/schemas/BulkActionEditPayloadTags'
      - $ref: '#/components/schemas/BulkActionEditPayloadIndexPatterns'
      - $ref: '#/components/schemas/BulkActionEditPayloadInvestigationFields'
      - $ref: '#/components/schemas/BulkActionEditPayloadTimeline'
      - $ref: '#/components/schemas/BulkActionEditPayloadRuleActions'
      - $ref: '#/components/schemas/BulkActionEditPayloadSchedule'
    BulkActionEditPayloadIndexPatterns:
      properties:
        overwrite_data_views:
          type: boolean
        type:
          enum:
          - add_index_patterns
          - delete_index_patterns
          - set_index_patterns
          type: string
        value:
          items:
            type: string
          type: array
      required:
      - type
      - value
      type: object
    BulkActionEditPayloadInvestigationFields:
      properties:
        type:
          enum:
          - add_investigation_fields
          - delete_investigation_fields
          - set_investigation_fields
          type: string
        value:
          $ref: '#/components/schemas/InvestigationFields'
      required:
      - type
      - value
      type: object
    BulkActionEditPayloadRuleActions:
      properties:
        type:
          enum:
          - add_rule_actions
          - set_rule_actions
          type: string
        value:
          $ref: '#/components/schemas/BulkActionEditPayloadRuleActions_value'
      required:
      - type
      - value
      type: object
    BulkActionEditPayloadSchedule:
      properties:
        type:
          enum:
          - set_schedule
          type: string
        value:
          $ref: '#/components/schemas/BulkActionEditPayloadSchedule_value'
      required:
      - type
      - value
      type: object
    BulkActionEditPayloadTags:
      properties:
        type:
          enum:
          - add_tags
          - delete_tags
          - set_tags
          - add_index_patterns
          - delete_index_patterns
          - set_index_patterns
          - add_investigation_fields
          - delete_investigation_fields
          - set_investigation_fields
          - set_timeline
          - add_rule_actions
          - set_rule_actions
          - set_schedule
          type: string
        value:
          description: "String array containing words and phrases to help categorize,\
            \ filter, and search rules. Defaults to an empty array."
          items:
            type: string
          type: array
      required:
      - type
      - value
      type: object
    BulkActionEditPayloadTimeline:
      properties:
        type:
          enum:
          - set_timeline
          type: string
        value:
          $ref: '#/components/schemas/BulkActionEditPayloadTimeline_value'
      required:
      - type
      - value
      type: object
    BulkActionsDryRunErrCode:
      enum:
      - IMMUTABLE
      - MACHINE_LEARNING_AUTH
      - MACHINE_LEARNING_INDEX_PATTERN
      - ESQL_INDEX_PATTERN
      - MANUAL_RULE_RUN_FEATURE
      - MANUAL_RULE_RUN_DISABLED_RULE
      type: string
    BulkActionSkipResult:
      properties:
        id:
          type: string
        name:
          type: string
        skip_reason:
          $ref: '#/components/schemas/BulkEditSkipReason'
      required:
      - id
      - skip_reason
      type: object
    BulkCrudRulesResponse:
      items:
        $ref: '#/components/schemas/BulkCrudRulesResponse_inner'
      type: array
    BulkDeleteRules:
      properties:
        action:
          enum:
          - delete
          type: string
        ids:
          description: Array of rule IDs
          items:
            type: string
          minItems: 1
          type: array
        query:
          description: Query to filter rules
          type: string
      required:
      - action
      type: object
    BulkDisableRules:
      properties:
        action:
          enum:
          - disable
          type: string
        ids:
          description: Array of rule IDs
          items:
            type: string
          minItems: 1
          type: array
        query:
          description: Query to filter rules
          type: string
      required:
      - action
      type: object
    BulkDuplicateRules:
      properties:
        action:
          enum:
          - duplicate
          type: string
        duplicate:
          $ref: '#/components/schemas/BulkDuplicateRules_duplicate'
        ids:
          description: Array of rule IDs
          items:
            type: string
          minItems: 1
          type: array
        query:
          description: Query to filter rules
          type: string
      required:
      - action
      type: object
    BulkEditActionResponse:
      properties:
        attributes:
          $ref: '#/components/schemas/BulkEditActionResponse_attributes'
        message:
          type: string
        rules_count:
          type: integer
        status_code:
          type: integer
        success:
          type: boolean
      required:
      - attributes
      type: object
    BulkEditActionResults:
      properties:
        created:
          items:
            $ref: '#/components/schemas/RuleResponse'
          type: array
        deleted:
          items:
            $ref: '#/components/schemas/RuleResponse'
          type: array
        skipped:
          items:
            $ref: '#/components/schemas/BulkActionSkipResult'
          type: array
        updated:
          items:
            $ref: '#/components/schemas/RuleResponse'
          type: array
      required:
      - created
      - deleted
      - skipped
      - updated
      type: object
    BulkEditActionSummary:
      properties:
        failed:
          type: integer
        skipped:
          type: integer
        succeeded:
          type: integer
        total:
          type: integer
      required:
      - failed
      - skipped
      - succeeded
      - total
      type: object
    BulkEditRules:
      properties:
        action:
          enum:
          - edit
          type: string
        edit:
          description: Array of objects containing the edit operations
          items:
            $ref: '#/components/schemas/BulkActionEditPayload'
          minItems: 1
          type: array
        ids:
          description: Array of rule IDs
          items:
            type: string
          minItems: 1
          type: array
        query:
          description: Query to filter rules
          type: string
      required:
      - action
      - edit
      type: object
    BulkEditSkipReason:
      enum:
      - RULE_NOT_MODIFIED
      type: string
    BulkEnableRules:
      properties:
        action:
          enum:
          - enable
          type: string
        ids:
          description: Array of rule IDs
          items:
            type: string
          minItems: 1
          type: array
        query:
          description: Query to filter rules
          type: string
      required:
      - action
      type: object
    BulkExportActionResponse:
      type: string
    BulkExportRules:
      properties:
        action:
          enum:
          - export
          type: string
        ids:
          description: Array of rule IDs
          items:
            type: string
          minItems: 1
          type: array
        query:
          description: Query to filter rules
          type: string
      required:
      - action
      type: object
    BulkManualRuleRun:
      properties:
        action:
          enum:
          - run
          type: string
        ids:
          description: Array of rule IDs
          items:
            type: string
          minItems: 1
          type: array
        query:
          description: Query to filter rules
          type: string
        run:
          $ref: '#/components/schemas/BulkManualRuleRun_run'
      required:
      - action
      - run
      type: object
    ConcurrentSearches:
      minimum: 1
      type: integer
    DataViewId:
      type: string
    DefaultParams:
      properties:
        command:
          enum:
          - isolate
          type: string
        comment:
          type: string
      required:
      - command
      type: object
    EcsMapping:
      additionalProperties:
        $ref: '#/components/schemas/EcsMapping_value'
      type: object
    EndpointResponseAction:
      properties:
        action_type_id:
          enum:
          - .endpoint
          type: string
        params:
          $ref: '#/components/schemas/EndpointResponseAction_params'
      required:
      - action_type_id
      - params
      type: object
    EqlOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/AlertSuppression'
        data_view_id:
          type: string
        event_category_override:
          type: string
        filters:
          items: {}
          type: array
        index:
          items:
            type: string
          type: array
        response_actions:
          items:
            $ref: '#/components/schemas/ResponseAction'
          type: array
        tiebreaker_field:
          description: Sets a secondary field for sorting events
          type: string
        timestamp_field:
          description: Contains the event timestamp used for sorting a sequence of
            events
          type: string
      type: object
    EqlQueryLanguage:
      enum:
      - eql
      type: string
    EqlRequiredFields:
      properties:
        language:
          $ref: '#/components/schemas/EqlQueryLanguage'
        query:
          type: string
        type:
          description: Rule type
          enum:
          - eql
          - query
          - saved_query
          - threshold
          - threat_match
          - machine_learning
          - new_terms
          - esql
          type: string
      required:
      - language
      - query
      - type
      type: object
    EqlRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/EqlRuleResponseFields'
    EqlRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/EqlRequiredFields'
      - $ref: '#/components/schemas/EqlOptionalFields'
    EqlRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/EqlRuleCreateFields'
    EqlRulePatchFields:
      allOf:
      - properties:
          language:
            $ref: '#/components/schemas/EqlQueryLanguage'
          query:
            $ref: '#/components/schemas/RuleQuery'
          type:
            description: Rule type
            enum:
            - eql
            - query
            - saved_query
            - threshold
            - threat_match
            - machine_learning
            - new_terms
            - esql
            type: string
        type: object
      - $ref: '#/components/schemas/EqlOptionalFields'
    EqlRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/EqlRulePatchFields'
    EqlRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/EqlRequiredFields'
      - $ref: '#/components/schemas/EqlOptionalFields'
    EqlRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/EqlRuleCreateFields'
    ErrorSchema:
      additionalProperties: false
      properties:
        error:
          $ref: '#/components/schemas/ErrorSchema_error'
        id:
          type: string
        item_id:
          minLength: 1
          type: string
        list_id:
          minLength: 1
          type: string
        rule_id:
          description: "Could be any string, not necessarily a UUID"
          type: string
      required:
      - error
      type: object
    EsqlQueryLanguage:
      enum:
      - esql
      type: string
    EsqlRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/EsqlRuleResponseFields'
    EsqlRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/EsqlRuleOptionalFields'
      - $ref: '#/components/schemas/EsqlRuleRequiredFields'
    EsqlRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/EsqlRuleCreateFields'
    EsqlRuleOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/AlertSuppression'
        response_actions:
          items:
            $ref: '#/components/schemas/ResponseAction'
          type: array
      type: object
    EsqlRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          language:
            $ref: '#/components/schemas/EsqlQueryLanguage'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          query:
            $ref: '#/components/schemas/RuleQuery'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          type:
            description: Rule type
            enum:
            - esql
            type: string
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/EsqlRuleOptionalFields'
    EsqlRuleRequiredFields:
      properties:
        language:
          $ref: '#/components/schemas/EsqlQueryLanguage'
        query:
          type: string
        type:
          description: Rule type
          enum:
          - esql
          type: string
      required:
      - language
      - query
      - type
      type: object
    EsqlRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/EsqlRuleOptionalFields'
      - $ref: '#/components/schemas/EsqlRuleRequiredFields'
    EsqlRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/EsqlRuleCreateFields'
    EventCategoryOverride:
      type: string
    ExceptionListType:
      description: The exception type
      enum:
      - detection
      - rule_default
      - endpoint
      - endpoint_trusted_apps
      - endpoint_events
      - endpoint_host_isolation_exceptions
      - endpoint_blocklists
      type: string
    ExternalRuleSource:
      description: "Type of rule source for externally sourced rules, i.e. rules that\
        \ have an external source, such as the Elastic Prebuilt rules repo."
      properties:
        is_customized:
          description: Determines whether an external/prebuilt rule has been customized
            by the user (i.e. any of its fields have been modified and diverged from
            the base value).
          type: boolean
        type:
          enum:
          - external
          - internal
          type: string
      required:
      - is_customized
      - type
      type: object
    FindRulesSortField:
      enum:
      - created_at
      - createdAt
      - enabled
      - execution_summary.last_execution.date
      - execution_summary.last_execution.metrics.execution_gap_duration_s
      - execution_summary.last_execution.metrics.total_indexing_duration_ms
      - execution_summary.last_execution.metrics.total_search_duration_ms
      - execution_summary.last_execution.status
      - name
      - risk_score
      - riskScore
      - severity
      - updated_at
      - updatedAt
      type: string
    HistoryWindowStart:
      $ref: '#/components/schemas/NonEmptyString'
    IndexMigrationStatus:
      properties:
        index:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        is_outdated:
          type: boolean
        migrations:
          items:
            $ref: '#/components/schemas/MigrationStatus'
          type: array
        signal_versions:
          items:
            $ref: '#/components/schemas/AlertVersion'
          type: array
        version:
          type: integer
      required:
      - index
      - is_outdated
      - migrations
      - signal_versions
      - version
      type: object
    IndexPatternArray:
      items:
        type: string
      type: array
    InternalRuleSource:
      description: "Type of rule source for internally sourced rules, i.e. created\
        \ within the Kibana apps."
      properties:
        type:
          enum:
          - internal
          type: string
      required:
      - type
      type: object
    InvestigationFields:
      description: |
        Schema for fields relating to investigation fields. These are user defined fields we use to highlight
        in various features in the UI such as alert details flyout and exceptions auto-population from alert.
        Added in PR #163235
        Right now we only have a single field but anticipate adding more related fields to store various
        configuration states such as `override` - where a user might say if they want only these fields to
        display, or if they want these fields + the fields we select. When expanding this field, it may look
        something like:
        ```typescript
        const investigationFields = z.object({
          field_names: NonEmptyArray(NonEmptyString),
          override: z.boolean().optional(),
        });
        ```
      properties:
        field_names:
          items:
            $ref: '#/components/schemas/NonEmptyString'
          minItems: 1
          type: array
      required:
      - field_names
      type: object
    InvestigationGuide:
      description: Notes to help investigate alerts produced by the rule.
      type: string
    IsExternalRuleCustomized:
      description: Determines whether an external/prebuilt rule has been customized
        by the user (i.e. any of its fields have been modified and diverged from the
        base value).
      type: boolean
    IsRuleEnabled:
      description: Determines whether the rule is enabled.
      type: boolean
    IsRuleImmutable:
      deprecated: true
      description: This field determines whether the rule is a prebuilt Elastic rule.
        It will be replaced with the `rule_source` field.
      type: boolean
    ItemsPerSearch:
      minimum: 1
      type: integer
    KqlQueryLanguage:
      enum:
      - kuery
      - lucene
      type: string
    MachineLearningJobId:
      description: Machine learning job ID
      oneOf:
      - type: string
      - items:
          type: string
        minItems: 1
        type: array
    MachineLearningRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/MachineLearningRuleResponseFields'
    MachineLearningRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/MachineLearningRuleRequiredFields'
      - $ref: '#/components/schemas/MachineLearningRuleOptionalFields'
    MachineLearningRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/MachineLearningRuleCreateFields'
    MachineLearningRuleOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/AlertSuppression'
      type: object
    MachineLearningRulePatchFields:
      allOf:
      - properties:
          anomaly_threshold:
            $ref: '#/components/schemas/AnomalyThreshold'
          machine_learning_job_id:
            $ref: '#/components/schemas/MachineLearningJobId'
          type:
            description: Rule type
            enum:
            - machine_learning
            type: string
        type: object
      - $ref: '#/components/schemas/MachineLearningRuleOptionalFields'
    MachineLearningRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/MachineLearningRulePatchFields'
    MachineLearningRuleRequiredFields:
      properties:
        anomaly_threshold:
          description: Anomaly threshold
          minimum: 0
          type: integer
        machine_learning_job_id:
          $ref: '#/components/schemas/MachineLearningJobId'
        type:
          description: Rule type
          enum:
          - machine_learning
          type: string
      required:
      - anomaly_threshold
      - machine_learning_job_id
      - type
      type: object
    MachineLearningRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/MachineLearningRuleRequiredFields'
      - $ref: '#/components/schemas/MachineLearningRuleOptionalFields'
    MachineLearningRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/MachineLearningRuleCreateFields'
    MaxSignals:
      minimum: 1
      type: integer
    MigrationCleanupResult:
      properties:
        destinationIndex:
          type: string
        error:
          $ref: '#/components/schemas/MigrationCleanupResult_error'
        id:
          type: string
        sourceIndex:
          type: string
        status:
          enum:
          - success
          - failure
          - pending
          type: string
        updated:
          format: date-time
          type: string
        version:
          type: string
      required:
      - destinationIndex
      - id
      - sourceIndex
      - status
      - updated
      - version
      type: object
    MigrationFinalizationResult:
      properties:
        completed:
          type: boolean
        destinationIndex:
          type: string
        error:
          $ref: '#/components/schemas/MigrationCleanupResult_error'
        id:
          type: string
        sourceIndex:
          type: string
        status:
          enum:
          - success
          - failure
          - pending
          type: string
        updated:
          format: date-time
          type: string
        version:
          type: string
      required:
      - completed
      - destinationIndex
      - id
      - sourceIndex
      - status
      - updated
      - version
      type: object
    MigrationStatus:
      properties:
        id:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        status:
          enum:
          - success
          - failure
          - pending
          type: string
        updated:
          format: date-time
          type: string
        version:
          type: integer
      required:
      - id
      - status
      - updated
      - version
      type: object
    NewTermsFields:
      items:
        type: string
      maxItems: 3
      minItems: 1
      type: array
    NewTermsRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/NewTermsRuleResponseFields'
    NewTermsRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/NewTermsRuleRequiredFields'
      - $ref: '#/components/schemas/NewTermsRuleOptionalFields'
      - $ref: '#/components/schemas/NewTermsRuleDefaultableFields'
    NewTermsRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/NewTermsRuleCreateFields'
    NewTermsRuleDefaultableFields:
      properties:
        language:
          $ref: '#/components/schemas/KqlQueryLanguage'
      type: object
    NewTermsRuleOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/AlertSuppression'
        data_view_id:
          type: string
        filters:
          items: {}
          type: array
        index:
          items:
            type: string
          type: array
        response_actions:
          items:
            $ref: '#/components/schemas/ResponseAction'
          type: array
      type: object
    NewTermsRulePatchFields:
      allOf:
      - properties:
          history_window_start:
            $ref: '#/components/schemas/HistoryWindowStart'
          new_terms_fields:
            $ref: '#/components/schemas/NewTermsFields'
          query:
            $ref: '#/components/schemas/RuleQuery'
          type:
            description: Rule type
            enum:
            - new_terms
            type: string
        type: object
      - $ref: '#/components/schemas/NewTermsRuleOptionalFields'
      - $ref: '#/components/schemas/NewTermsRuleDefaultableFields'
    NewTermsRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/NewTermsRulePatchFields'
    NewTermsRuleRequiredFields:
      properties:
        history_window_start:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        new_terms_fields:
          items:
            type: string
          maxItems: 3
          minItems: 1
          type: array
        query:
          type: string
        type:
          description: Rule type
          enum:
          - new_terms
          type: string
      required:
      - history_window_start
      - new_terms_fields
      - query
      - type
      type: object
    NewTermsRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/NewTermsRuleRequiredFields'
      - $ref: '#/components/schemas/NewTermsRuleOptionalFields'
      - properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
        required:
        - language
        type: object
    NewTermsRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/NewTermsRuleCreateFields'
    NonEmptyString:
      description: A string that is not empty and does not contain only whitespace
      minLength: 1
      pattern: ^(?! *$).+$
      type: string
    NormalizedRuleAction:
      additionalProperties: false
      properties:
        alerts_filter:
          additionalProperties: true
          type: object
        frequency:
          $ref: '#/components/schemas/RuleActionFrequency'
        group:
          description: Optionally groups actions by use cases. Use `default` for alert
            notifications.
          type: string
        id:
          description: The connector ID.
          type: string
        params:
          additionalProperties: true
          description: "Object containing the allowed connector fields, which varies\
            \ according to the connector type."
          type: object
      required:
      - id
      - params
      type: object
    NormalizedRuleError:
      properties:
        err_code:
          $ref: '#/components/schemas/BulkActionsDryRunErrCode'
        message:
          type: string
        rules:
          items:
            $ref: '#/components/schemas/RuleDetailsInError'
          type: array
        status_code:
          type: integer
      required:
      - message
      - rules
      - status_code
      type: object
    OsqueryParams:
      properties:
        ecs_mapping:
          additionalProperties:
            $ref: '#/components/schemas/EcsMapping_value'
          type: object
        pack_id:
          type: string
        queries:
          items:
            $ref: '#/components/schemas/OsqueryQuery'
          type: array
        query:
          type: string
        saved_query_id:
          type: string
        timeout:
          type: number
      type: object
    OsqueryQuery:
      properties:
        ecs_mapping:
          additionalProperties:
            $ref: '#/components/schemas/EcsMapping_value'
          type: object
        id:
          description: Query ID
          type: string
        platform:
          type: string
        query:
          description: Query to run
          type: string
        removed:
          type: boolean
        snapshot:
          type: boolean
        version:
          description: Query version
          type: string
      required:
      - id
      - query
      type: object
    OsqueryResponseAction:
      properties:
        action_type_id:
          enum:
          - .osquery
          type: string
        params:
          $ref: '#/components/schemas/OsqueryParams'
      required:
      - action_type_id
      - params
      type: object
    PlatformErrorResponse:
      properties:
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
      required:
      - error
      - message
      - statusCode
      type: object
    ProcessesParams:
      properties:
        command:
          enum:
          - kill-process
          - suspend-process
          type: string
        comment:
          type: string
        config:
          $ref: '#/components/schemas/ProcessesParams_config'
      required:
      - command
      - config
      type: object
    QueryRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/QueryRuleResponseFields'
    QueryRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/QueryRuleRequiredFields'
      - $ref: '#/components/schemas/QueryRuleOptionalFields'
      - $ref: '#/components/schemas/QueryRuleDefaultableFields'
    QueryRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/QueryRuleCreateFields'
    QueryRuleDefaultableFields:
      properties:
        language:
          $ref: '#/components/schemas/KqlQueryLanguage'
        query:
          type: string
      type: object
    QueryRuleOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/AlertSuppression'
        data_view_id:
          type: string
        filters:
          items: {}
          type: array
        index:
          items:
            type: string
          type: array
        response_actions:
          items:
            $ref: '#/components/schemas/ResponseAction'
          type: array
        saved_id:
          type: string
      type: object
    QueryRulePatchFields:
      allOf:
      - properties:
          type:
            description: Rule type
            enum:
            - query
            type: string
        type: object
      - $ref: '#/components/schemas/QueryRuleOptionalFields'
      - $ref: '#/components/schemas/QueryRuleDefaultableFields'
    QueryRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/QueryRulePatchFields'
    QueryRuleRequiredFields:
      properties:
        type:
          description: Rule type
          enum:
          - query
          type: string
      required:
      - type
      type: object
    QueryRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/QueryRuleRequiredFields'
      - $ref: '#/components/schemas/QueryRuleOptionalFields'
      - properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
          query:
            $ref: '#/components/schemas/RuleQuery'
        required:
        - language
        - query
        type: object
    QueryRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/QueryRuleCreateFields'
    RelatedIntegration:
      description: |
        Related integration is a potential dependency of a rule. It's assumed that if the user installs
        one of the related integrations of a rule, the rule might start to work properly because it will
        have source events (generated by this integration) potentially matching the rule's query.

        NOTE: Proper work is not guaranteed, because a related integration, if installed, can be
        configured differently or generate data that is not necessarily relevant for this rule.

        Related integration is a combination of a Fleet package and (optionally) one of the
        package's "integrations" that this package contains. It is represented by 3 properties:

        - `package`: name of the package (required, unique id)
        - `version`: version of the package (required, semver-compatible)
        - `integration`: name of the integration of this package (optional, id within the package)

        There are Fleet packages like `windows` that contain only one integration; in this case,
        `integration` should be unspecified. There are also packages like `aws` and `azure` that contain
        several integrations; in this case, `integration` should be specified.

        @example
        const x: RelatedIntegration = {
          package: 'windows',
          version: '1.5.x',
        };

        @example
        const x: RelatedIntegration = {
          package: 'azure',
          version: '~1.1.6',
          integration: 'activitylogs',
        };
      properties:
        integration:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        package:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        version:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
      required:
      - package
      - version
      type: object
    RelatedIntegrationArray:
      items:
        $ref: '#/components/schemas/RelatedIntegration'
      type: array
    RequiredField:
      description: |
        Describes an Elasticsearch field that is needed for the rule to function.

        Almost all types of Security rules check source event documents for a match to some kind of
        query or filter. If a document has certain field with certain values, then it's a match and
        the rule will generate an alert.

        Required field is an event field that must be present in the source indices of a given rule.

        @example
        const standardEcsField: RequiredField = {
          name: 'event.action',
          type: 'keyword',
          ecs: true,
        };

        @example
        const nonEcsField: RequiredField = {
          name: 'winlog.event_data.AttributeLDAPDisplayName',
          type: 'keyword',
          ecs: false,
        };
      properties:
        ecs:
          description: Whether the field is an ECS field
          type: boolean
        name:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        type:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
      required:
      - ecs
      - name
      - type
      type: object
    RequiredFieldArray:
      items:
        $ref: '#/components/schemas/RequiredField'
      type: array
    RequiredFieldInput:
      description: "Input parameters to create a RequiredField. Does not include the\
        \ `ecs` field, because `ecs` is calculated on the backend based on the field\
        \ name and type."
      properties:
        name:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        type:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
      required:
      - name
      - type
      type: object
    ResponseAction:
      oneOf:
      - $ref: '#/components/schemas/OsqueryResponseAction'
      - $ref: '#/components/schemas/EndpointResponseAction'
    ResponseFields:
      properties:
        created_at:
          format: date-time
          type: string
        created_by:
          type: string
        execution_summary:
          $ref: '#/components/schemas/RuleExecutionSummary'
        id:
          description: A universally unique identifier
          format: uuid
          type: string
        immutable:
          deprecated: true
          description: This field determines whether the rule is a prebuilt Elastic
            rule. It will be replaced with the `rule_source` field.
          type: boolean
        required_fields:
          items:
            $ref: '#/components/schemas/RequiredField'
          type: array
        revision:
          minimum: 0
          type: integer
        rule_id:
          description: "Could be any string, not necessarily a UUID"
          type: string
        rule_source:
          $ref: '#/components/schemas/RuleSource'
        updated_at:
          format: date-time
          type: string
        updated_by:
          type: string
      required:
      - created_at
      - created_by
      - id
      - immutable
      - related_integrations
      - required_fields
      - revision
      - rule_id
      - updated_at
      - updated_by
      type: object
    RiskScore:
      description: Risk score (0 to 100)
      maximum: 100
      minimum: 0
      type: integer
    RiskScoreMapping:
      description: Overrides generated alerts' risk_score with a value from the source
        event
      items:
        $ref: '#/components/schemas/RiskScoreMapping_inner'
      type: array
    RuleAction:
      properties:
        action_type_id:
          description: The action type used for sending notifications.
          type: string
        alerts_filter:
          additionalProperties: true
          type: object
        frequency:
          $ref: '#/components/schemas/RuleActionFrequency'
        group:
          description: Optionally groups actions by use cases. Use `default` for alert
            notifications.
          type: string
        id:
          description: The connector ID.
          type: string
        params:
          additionalProperties: true
          description: "Object containing the allowed connector fields, which varies\
            \ according to the connector type."
          type: object
        uuid:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
      required:
      - action_type_id
      - id
      - params
      type: object
    RuleActionAlertsFilter:
      additionalProperties: true
      type: object
    RuleActionFrequency:
      description: "The action frequency defines when the action runs (for example,\
        \ only on rule execution or at specific time intervals)."
      properties:
        notifyWhen:
          $ref: '#/components/schemas/RuleActionNotifyWhen'
        summary:
          description: Action summary indicates whether we will send a summary notification
            about all the generate alerts or notification per individual alert
          type: boolean
        throttle:
          $ref: '#/components/schemas/RuleActionThrottle'
      required:
      - notifyWhen
      - summary
      - throttle
      type: object
    RuleActionGroup:
      description: Optionally groups actions by use cases. Use `default` for alert
        notifications.
      type: string
    RuleActionId:
      description: The connector ID.
      type: string
    RuleActionNotifyWhen:
      description: "The condition for throttling the notification: `onActionGroupChange`,\
        \ `onActiveAlert`,  or `onThrottleInterval`"
      enum:
      - onActiveAlert
      - onThrottleInterval
      - onActionGroupChange
      type: string
    RuleActionParams:
      additionalProperties: true
      description: "Object containing the allowed connector fields, which varies according\
        \ to the connector type."
      type: object
    RuleActionThrottle:
      description: Defines how often rule actions are taken.
      oneOf:
      - enum:
        - no_actions
        - rule
        type: string
      - description: "Time interval in seconds, minutes, hours, or days."
        example: 1h
        pattern: "^[1-9]\\d*[smhd]$"
        type: string
    RuleAuthorArray:
      items:
        type: string
      type: array
    RuleCreateProps:
      anyOf:
      - $ref: '#/components/schemas/EqlRuleCreateProps'
      - $ref: '#/components/schemas/QueryRuleCreateProps'
      - $ref: '#/components/schemas/SavedQueryRuleCreateProps'
      - $ref: '#/components/schemas/ThresholdRuleCreateProps'
      - $ref: '#/components/schemas/ThreatMatchRuleCreateProps'
      - $ref: '#/components/schemas/MachineLearningRuleCreateProps'
      - $ref: '#/components/schemas/NewTermsRuleCreateProps'
      - $ref: '#/components/schemas/EsqlRuleCreateProps'
      discriminator:
        propertyName: type
    RuleDescription:
      minLength: 1
      type: string
    RuleDetailsInError:
      properties:
        id:
          type: string
        name:
          type: string
      required:
      - id
      type: object
    RuleExceptionList:
      properties:
        id:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        list_id:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        namespace_type:
          description: Determines the exceptions validity in rule's Kibana space
          enum:
          - agnostic
          - single
          type: string
        type:
          $ref: '#/components/schemas/ExceptionListType'
      required:
      - id
      - list_id
      - namespace_type
      - type
      type: object
    RuleExecutionMetrics:
      properties:
        execution_gap_duration_s:
          description: Duration in seconds of execution gap
          minimum: 0
          type: integer
        total_enrichment_duration_ms:
          description: Total time spent enriching documents during current rule execution
            cycle
          minimum: 0
          type: integer
        total_indexing_duration_ms:
          description: Total time spent indexing documents during current rule execution
            cycle
          minimum: 0
          type: integer
        total_search_duration_ms:
          description: Total time spent performing ES searches as measured by Kibana;
            includes network latency and time spent serializing/deserializing request/response
          minimum: 0
          type: integer
      type: object
    RuleExecutionStatus:
      description: |-
        Custom execution status of Security rules that is different from the status used in the Alerting Framework. We merge our custom status with the Framework's status to determine the resulting status of a rule.
        - going to run - @deprecated Replaced by the 'running' status but left for backwards compatibility with rule execution events already written to Event Log in the prior versions of Kibana. Don't use when writing rule status changes.
        - running - Rule execution started but not reached any intermediate or final status.
        - partial failure - Rule can partially fail for various reasons either in the middle of an execution (in this case we update its status right away) or in the end of it. So currently this status can be both intermediate and final at the same time. A typical reason for a partial failure: not all the indices that the rule searches over actually exist.
        - failed - Rule failed to execute due to unhandled exception or a reason defined in the business logic of its executor function.
        - succeeded - Rule executed successfully without any issues. Note: this status is just an indication of a rule's "health". The rule might or might not generate any alerts despite of it.
      enum:
      - going to run
      - running
      - partial failure
      - failed
      - succeeded
      type: string
    RuleExecutionStatusOrder:
      type: integer
    RuleExecutionSummary:
      properties:
        last_execution:
          $ref: '#/components/schemas/RuleExecutionSummary_last_execution'
      required:
      - last_execution
      type: object
    RuleFalsePositiveArray:
      items:
        type: string
      type: array
    RuleFilterArray:
      items: {}
      type: array
    RuleInterval:
      description: "Frequency of rule execution, using a date math range. For example,\
        \ \"1h\" means the rule runs every hour. Defaults to 5m (5 minutes)."
      type: string
    RuleIntervalFrom:
      description: "Time from which data is analyzed each time the rule runs, using\
        \ a date math range. For example, now-4200s means the rule analyzes data from\
        \ 70 minutes before its start time. Defaults to now-6m (analyzes data from\
        \ 6 minutes before the start time)."
      format: date-math
      type: string
    RuleIntervalTo:
      type: string
    RuleLicense:
      description: The rule's license.
      type: string
    RuleMetadata:
      additionalProperties: true
      type: object
    RuleName:
      minLength: 1
      type: string
    RuleNameOverride:
      description: Sets the source field for the alert's signal.rule.name value
      type: string
    RuleObjectId:
      $ref: '#/components/schemas/UUID'
    RulePatchProps:
      anyOf:
      - $ref: '#/components/schemas/EqlRulePatchProps'
      - $ref: '#/components/schemas/QueryRulePatchProps'
      - $ref: '#/components/schemas/SavedQueryRulePatchProps'
      - $ref: '#/components/schemas/ThresholdRulePatchProps'
      - $ref: '#/components/schemas/ThreatMatchRulePatchProps'
      - $ref: '#/components/schemas/MachineLearningRulePatchProps'
      - $ref: '#/components/schemas/NewTermsRulePatchProps'
      - $ref: '#/components/schemas/EsqlRulePatchProps'
    RulePreviewLoggedRequest:
      properties:
        description:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        duration:
          type: integer
        request:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
      required:
      - request
      type: object
    RulePreviewLogs:
      properties:
        duration:
          description: Execution duration in milliseconds
          type: integer
        errors:
          items:
            $ref: '#/components/schemas/NonEmptyString'
          type: array
        requests:
          items:
            $ref: '#/components/schemas/RulePreviewLoggedRequest'
          type: array
        startedAt:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        warnings:
          items:
            $ref: '#/components/schemas/NonEmptyString'
          type: array
      required:
      - duration
      - errors
      - warnings
      type: object
    RulePreviewParams:
      properties:
        invocationCount:
          type: integer
        timeframeEnd:
          format: date-time
          type: string
      required:
      - invocationCount
      - timeframeEnd
      type: object
    RuleQuery:
      type: string
    RuleReferenceArray:
      items:
        type: string
      type: array
    RuleResponse:
      anyOf:
      - $ref: '#/components/schemas/EqlRule'
      - $ref: '#/components/schemas/QueryRule'
      - $ref: '#/components/schemas/SavedQueryRule'
      - $ref: '#/components/schemas/ThresholdRule'
      - $ref: '#/components/schemas/ThreatMatchRule'
      - $ref: '#/components/schemas/MachineLearningRule'
      - $ref: '#/components/schemas/NewTermsRule'
      - $ref: '#/components/schemas/EsqlRule'
      discriminator:
        propertyName: type
    RuleSignatureId:
      description: "Could be any string, not necessarily a UUID"
      type: string
    RuleSource:
      anyOf:
      - $ref: '#/components/schemas/ExternalRuleSource'
      - $ref: '#/components/schemas/InternalRuleSource'
      description: "Discriminated union that determines whether the rule is internally\
        \ sourced (created within the Kibana app) or has an external source, such\
        \ as the Elastic Prebuilt rules repo."
      discriminator:
        propertyName: type
    RuleTagArray:
      description: "String array containing words and phrases to help categorize,\
        \ filter, and search rules. Defaults to an empty array."
      items:
        type: string
      type: array
    RuleUpdateProps:
      anyOf:
      - $ref: '#/components/schemas/EqlRuleUpdateProps'
      - $ref: '#/components/schemas/QueryRuleUpdateProps'
      - $ref: '#/components/schemas/SavedQueryRuleUpdateProps'
      - $ref: '#/components/schemas/ThresholdRuleUpdateProps'
      - $ref: '#/components/schemas/ThreatMatchRuleUpdateProps'
      - $ref: '#/components/schemas/MachineLearningRuleUpdateProps'
      - $ref: '#/components/schemas/NewTermsRuleUpdateProps'
      - $ref: '#/components/schemas/EsqlRuleUpdateProps'
      discriminator:
        propertyName: type
    RuleVersion:
      description: The rule's version number.
      minimum: 1
      type: integer
    SavedObjectResolveAliasPurpose:
      enum:
      - savedObjectConversion
      - savedObjectImport
      type: string
    SavedObjectResolveAliasTargetId:
      type: string
    SavedObjectResolveOutcome:
      enum:
      - exactMatch
      - aliasMatch
      - conflict
      type: string
    SavedQueryId:
      type: string
    SavedQueryRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/SavedQueryRuleResponseFields'
    SavedQueryRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/SavedQueryRuleRequiredFields'
      - $ref: '#/components/schemas/SavedQueryRuleOptionalFields'
      - $ref: '#/components/schemas/SavedQueryRuleDefaultableFields'
    SavedQueryRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/SavedQueryRuleCreateFields'
    SavedQueryRuleDefaultableFields:
      properties:
        language:
          $ref: '#/components/schemas/KqlQueryLanguage'
      type: object
    SavedQueryRuleOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/AlertSuppression'
        data_view_id:
          type: string
        filters:
          items: {}
          type: array
        index:
          items:
            type: string
          type: array
        query:
          type: string
        response_actions:
          items:
            $ref: '#/components/schemas/ResponseAction'
          type: array
      type: object
    SavedQueryRulePatchFields:
      allOf:
      - properties:
          saved_id:
            $ref: '#/components/schemas/SavedQueryId'
          type:
            description: Rule type
            enum:
            - saved_query
            type: string
        type: object
      - $ref: '#/components/schemas/SavedQueryRuleOptionalFields'
      - $ref: '#/components/schemas/SavedQueryRuleDefaultableFields'
    SavedQueryRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/SavedQueryRulePatchFields'
    SavedQueryRuleRequiredFields:
      properties:
        saved_id:
          type: string
        type:
          description: Rule type
          enum:
          - saved_query
          type: string
      required:
      - saved_id
      - type
      type: object
    SavedQueryRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/SavedQueryRuleRequiredFields'
      - $ref: '#/components/schemas/SavedQueryRuleOptionalFields'
      - properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
        required:
        - language
        type: object
    SavedQueryRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/SavedQueryRuleCreateFields'
    SetAlertsStatusByIds:
      properties:
        signal_ids:
          items:
            $ref: '#/components/schemas/NonEmptyString'
          minItems: 1
          type: array
        status:
          $ref: '#/components/schemas/AlertStatus'
      required:
      - signal_ids
      - status
      type: object
    SetAlertsStatusByQuery:
      properties:
        conflicts:
          default: abort
          enum:
          - abort
          - proceed
          type: string
        query:
          additionalProperties: true
          type: object
        status:
          $ref: '#/components/schemas/AlertStatus'
      required:
      - query
      - status
      type: object
    SetAlertTags:
      properties:
        tags_to_add:
          items:
            $ref: '#/components/schemas/AlertTag'
          type: array
        tags_to_remove:
          items:
            $ref: '#/components/schemas/AlertTag'
          type: array
      required:
      - tags_to_add
      - tags_to_remove
      type: object
    SetupGuide:
      type: string
    Severity:
      description: Severity of the rule
      enum:
      - low
      - medium
      - high
      - critical
      type: string
    SeverityMapping:
      description: Overrides generated alerts' severity with values from the source
        event
      items:
        $ref: '#/components/schemas/SeverityMapping_inner'
      type: array
    SiemErrorResponse:
      properties:
        message:
          type: string
        status_code:
          type: integer
      required:
      - message
      - status_code
      type: object
    SkippedAlertsIndexMigration:
      properties:
        index:
          type: string
      required:
      - index
      type: object
    SortOrder:
      enum:
      - asc
      - desc
      type: string
    Threat:
      properties:
        framework:
          description: Relevant attack framework
          type: string
        tactic:
          $ref: '#/components/schemas/ThreatTactic'
        technique:
          description: Array containing information on the attack techniques (optional)
          items:
            $ref: '#/components/schemas/ThreatTechnique'
          type: array
      required:
      - framework
      - tactic
      type: object
    ThreatArray:
      items:
        $ref: '#/components/schemas/Threat'
      type: array
    ThreatFilters:
      items:
        description: Query and filter context array used to filter documents from
          the Elasticsearch index containing the threat values
      type: array
    ThreatIndex:
      items:
        type: string
      type: array
    ThreatIndicatorPath:
      description: Defines the path to the threat indicator in the indicator documents
        (optional)
      type: string
    ThreatMapping:
      items:
        $ref: '#/components/schemas/ThreatMapping_inner'
      minItems: 1
      type: array
    ThreatMatchRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/ThreatMatchRuleResponseFields'
    ThreatMatchRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/ThreatMatchRuleRequiredFields'
      - $ref: '#/components/schemas/ThreatMatchRuleOptionalFields'
      - $ref: '#/components/schemas/ThreatMatchRuleDefaultableFields'
    ThreatMatchRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/ThreatMatchRuleCreateFields'
    ThreatMatchRuleDefaultableFields:
      properties:
        language:
          $ref: '#/components/schemas/KqlQueryLanguage'
      type: object
    ThreatMatchRuleOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/AlertSuppression'
        concurrent_searches:
          minimum: 1
          type: integer
        data_view_id:
          type: string
        filters:
          items: {}
          type: array
        index:
          items:
            type: string
          type: array
        items_per_search:
          minimum: 1
          type: integer
        saved_id:
          type: string
        threat_filters:
          items:
            description: Query and filter context array used to filter documents from
              the Elasticsearch index containing the threat values
          type: array
        threat_indicator_path:
          description: Defines the path to the threat indicator in the indicator documents
            (optional)
          type: string
        threat_language:
          $ref: '#/components/schemas/KqlQueryLanguage'
      type: object
    ThreatMatchRulePatchFields:
      allOf:
      - properties:
          query:
            $ref: '#/components/schemas/RuleQuery'
          threat_index:
            $ref: '#/components/schemas/ThreatIndex'
          threat_mapping:
            $ref: '#/components/schemas/ThreatMapping'
          threat_query:
            $ref: '#/components/schemas/ThreatQuery'
          type:
            description: Rule type
            enum:
            - threat_match
            type: string
        type: object
      - $ref: '#/components/schemas/ThreatMatchRuleOptionalFields'
      - $ref: '#/components/schemas/ThreatMatchRuleDefaultableFields'
    ThreatMatchRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/ThreatMatchRulePatchFields'
    ThreatMatchRuleRequiredFields:
      properties:
        query:
          type: string
        threat_index:
          items:
            type: string
          type: array
        threat_mapping:
          items:
            $ref: '#/components/schemas/ThreatMapping_inner'
          minItems: 1
          type: array
        threat_query:
          description: Query to run
          type: string
        type:
          description: Rule type
          enum:
          - threat_match
          type: string
      required:
      - query
      - threat_index
      - threat_mapping
      - threat_query
      - type
      type: object
    ThreatMatchRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/ThreatMatchRuleRequiredFields'
      - $ref: '#/components/schemas/ThreatMatchRuleOptionalFields'
      - properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
        required:
        - language
        type: object
    ThreatMatchRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/ThreatMatchRuleCreateFields'
    ThreatQuery:
      description: Query to run
      type: string
    ThreatSubtechnique:
      properties:
        id:
          description: Subtechnique ID
          type: string
        name:
          description: Subtechnique name
          type: string
        reference:
          description: Subtechnique reference
          type: string
      required:
      - id
      - name
      - reference
      type: object
    ThreatTactic:
      properties:
        id:
          description: Tactic ID
          type: string
        name:
          description: Tactic name
          type: string
        reference:
          description: Tactic reference
          type: string
      required:
      - id
      - name
      - reference
      type: object
    ThreatTechnique:
      properties:
        id:
          description: Technique ID
          type: string
        name:
          description: Technique name
          type: string
        reference:
          description: Technique reference
          type: string
        subtechnique:
          description: Array containing more specific information on the attack technique
          items:
            $ref: '#/components/schemas/ThreatSubtechnique'
          type: array
      required:
      - id
      - name
      - reference
      type: object
    Threshold:
      properties:
        cardinality:
          items:
            $ref: '#/components/schemas/ThresholdCardinality_inner'
          type: array
        field:
          $ref: '#/components/schemas/ThresholdField'
        value:
          description: Threshold value
          minimum: 1
          type: integer
      required:
      - field
      - value
      type: object
    ThresholdAlertSuppression:
      properties:
        duration:
          $ref: '#/components/schemas/AlertSuppressionDuration'
      required:
      - duration
      type: object
    ThresholdCardinality:
      items:
        $ref: '#/components/schemas/ThresholdCardinality_inner'
      type: array
    ThresholdField:
      description: Field to aggregate on
      oneOf:
      - type: string
      - items:
          type: string
        type: array
    ThresholdRule:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - actions
        - author
        - description
        - enabled
        - exceptions_list
        - false_positives
        - from
        - interval
        - max_signals
        - name
        - references
        - related_integrations
        - required_fields
        - risk_score
        - risk_score_mapping
        - setup
        - severity
        - severity_mapping
        - tags
        - threat
        - to
        - version
        type: object
      - $ref: '#/components/schemas/ResponseFields'
      - $ref: '#/components/schemas/ThresholdRuleResponseFields'
    ThresholdRuleCreateFields:
      allOf:
      - $ref: '#/components/schemas/ThresholdRuleRequiredFields'
      - $ref: '#/components/schemas/ThresholdRuleOptionalFields'
      - $ref: '#/components/schemas/ThresholdRuleDefaultableFields'
    ThresholdRuleCreateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/ThresholdRuleCreateFields'
    ThresholdRuleDefaultableFields:
      properties:
        language:
          $ref: '#/components/schemas/KqlQueryLanguage'
      type: object
    ThresholdRuleOptionalFields:
      properties:
        alert_suppression:
          $ref: '#/components/schemas/ThresholdAlertSuppression'
        data_view_id:
          type: string
        filters:
          items: {}
          type: array
        index:
          items:
            type: string
          type: array
        saved_id:
          type: string
      type: object
    ThresholdRulePatchFields:
      allOf:
      - properties:
          query:
            $ref: '#/components/schemas/RuleQuery'
          threshold:
            $ref: '#/components/schemas/Threshold'
          type:
            description: Rule type
            enum:
            - threshold
            type: string
        type: object
      - $ref: '#/components/schemas/ThresholdRuleOptionalFields'
      - $ref: '#/components/schemas/ThresholdRuleDefaultableFields'
    ThresholdRulePatchProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        type: object
      - $ref: '#/components/schemas/ThresholdRulePatchFields'
    ThresholdRuleRequiredFields:
      properties:
        query:
          type: string
        threshold:
          $ref: '#/components/schemas/Threshold'
        type:
          description: Rule type
          enum:
          - threshold
          type: string
      required:
      - query
      - threshold
      - type
      type: object
    ThresholdRuleResponseFields:
      allOf:
      - $ref: '#/components/schemas/ThresholdRuleRequiredFields'
      - $ref: '#/components/schemas/ThresholdRuleOptionalFields'
      - properties:
          language:
            $ref: '#/components/schemas/KqlQueryLanguage'
        required:
        - language
        type: object
    ThresholdRuleUpdateProps:
      allOf:
      - properties:
          actions:
            items:
              $ref: '#/components/schemas/RuleAction'
            type: array
          alias_purpose:
            $ref: '#/components/schemas/SavedObjectResolveAliasPurpose'
          alias_target_id:
            $ref: '#/components/schemas/SavedObjectResolveAliasTargetId'
          author:
            $ref: '#/components/schemas/RuleAuthorArray'
          building_block_type:
            $ref: '#/components/schemas/BuildingBlockType'
          description:
            $ref: '#/components/schemas/RuleDescription'
          enabled:
            $ref: '#/components/schemas/IsRuleEnabled'
          exceptions_list:
            items:
              $ref: '#/components/schemas/RuleExceptionList'
            type: array
          false_positives:
            $ref: '#/components/schemas/RuleFalsePositiveArray'
          from:
            $ref: '#/components/schemas/RuleIntervalFrom'
          id:
            $ref: '#/components/schemas/RuleObjectId'
          interval:
            $ref: '#/components/schemas/RuleInterval'
          investigation_fields:
            $ref: '#/components/schemas/InvestigationFields'
          license:
            $ref: '#/components/schemas/RuleLicense'
          max_signals:
            $ref: '#/components/schemas/MaxSignals'
          meta:
            $ref: '#/components/schemas/RuleMetadata'
          name:
            $ref: '#/components/schemas/RuleName'
          namespace:
            $ref: '#/components/schemas/AlertsIndexNamespace'
          note:
            $ref: '#/components/schemas/InvestigationGuide'
          outcome:
            $ref: '#/components/schemas/SavedObjectResolveOutcome'
          output_index:
            $ref: '#/components/schemas/AlertsIndex'
          references:
            $ref: '#/components/schemas/RuleReferenceArray'
          related_integrations:
            $ref: '#/components/schemas/RelatedIntegrationArray'
          required_fields:
            items:
              $ref: '#/components/schemas/RequiredFieldInput'
            type: array
          risk_score:
            $ref: '#/components/schemas/RiskScore'
          risk_score_mapping:
            $ref: '#/components/schemas/RiskScoreMapping'
          rule_id:
            $ref: '#/components/schemas/RuleSignatureId'
          rule_name_override:
            $ref: '#/components/schemas/RuleNameOverride'
          setup:
            $ref: '#/components/schemas/SetupGuide'
          severity:
            $ref: '#/components/schemas/Severity'
          severity_mapping:
            $ref: '#/components/schemas/SeverityMapping'
          tags:
            $ref: '#/components/schemas/RuleTagArray'
          threat:
            $ref: '#/components/schemas/ThreatArray'
          throttle:
            $ref: '#/components/schemas/RuleActionThrottle'
          timeline_id:
            $ref: '#/components/schemas/TimelineTemplateId'
          timeline_title:
            $ref: '#/components/schemas/TimelineTemplateTitle'
          timestamp_override:
            $ref: '#/components/schemas/TimestampOverride'
          timestamp_override_fallback_disabled:
            $ref: '#/components/schemas/TimestampOverrideFallbackDisabled'
          to:
            $ref: '#/components/schemas/RuleIntervalTo'
          version:
            $ref: '#/components/schemas/RuleVersion'
        required:
        - description
        - name
        - risk_score
        - severity
        type: object
      - $ref: '#/components/schemas/ThresholdRuleCreateFields'
    ThresholdValue:
      description: Threshold value
      minimum: 1
      type: integer
    ThrottleForBulkActions:
      description: "The condition for throttling the notification: 'rule', 'no_actions',\
        \ or time duration"
      enum:
      - rule
      - 1h
      - 1d
      - 7d
      type: string
    TiebreakerField:
      description: Sets a secondary field for sorting events
      type: string
    TimelineTemplateId:
      description: Timeline template ID
      type: string
    TimelineTemplateTitle:
      description: Timeline template title
      type: string
    TimestampField:
      description: Contains the event timestamp used for sorting a sequence of events
      type: string
    TimestampOverride:
      description: Sets the time field used to query indices
      type: string
    TimestampOverrideFallbackDisabled:
      description: Disables the fallback to the event's @timestamp field
      type: boolean
    UUID:
      description: A universally unique identifier
      format: uuid
      type: string
    WarningSchema:
      properties:
        actionPath:
          type: string
        buttonLabel:
          type: string
        message:
          type: string
        type:
          type: string
      required:
      - actionPath
      - message
      - type
      type: object
    BulkActionEditPayloadRuleActions_value:
      properties:
        actions:
          items:
            $ref: '#/components/schemas/NormalizedRuleAction'
          type: array
        throttle:
          $ref: '#/components/schemas/ThrottleForBulkActions'
      required:
      - actions
      type: object
    BulkActionEditPayloadSchedule_value:
      properties:
        interval:
          description: "Interval in which the rule runs. For example, `\"1h\"` means\
            \ the rule runs every hour."
          example: 1h
          pattern: "^[1-9]\\d*[smh]$"
          type: string
        lookback:
          description: Lookback time for the rule
          example: 1h
          pattern: "^[1-9]\\d*[smh]$"
          type: string
      required:
      - interval
      - lookback
      type: object
    BulkActionEditPayloadTimeline_value:
      properties:
        timeline_id:
          description: Timeline template ID
          type: string
        timeline_title:
          description: Timeline template title
          type: string
      required:
      - timeline_id
      - timeline_title
      type: object
    BulkCrudRulesResponse_inner:
      oneOf:
      - $ref: '#/components/schemas/RuleResponse'
      - $ref: '#/components/schemas/ErrorSchema'
    BulkDuplicateRules_duplicate:
      properties:
        include_exceptions:
          description: Whether to copy exceptions from the original rule
          type: boolean
        include_expired_exceptions:
          description: Whether to copy expired exceptions from the original rule
          type: boolean
      required:
      - include_exceptions
      - include_expired_exceptions
      type: object
    BulkEditActionResponse_attributes:
      properties:
        errors:
          items:
            $ref: '#/components/schemas/NormalizedRuleError'
          type: array
        results:
          $ref: '#/components/schemas/BulkEditActionResults'
        summary:
          $ref: '#/components/schemas/BulkEditActionSummary'
      required:
      - results
      - summary
      type: object
    BulkManualRuleRun_run:
      properties:
        end_date:
          description: End date of the manual rule run
          type: string
        start_date:
          description: Start date of the manual rule run
          type: string
      required:
      - start_date
      type: object
    EcsMapping_value_value:
      oneOf:
      - type: string
      - items:
          type: string
        type: array
    EcsMapping_value:
      properties:
        field:
          type: string
        value:
          $ref: '#/components/schemas/EcsMapping_value_value'
      type: object
    EndpointResponseAction_params:
      oneOf:
      - $ref: '#/components/schemas/DefaultParams'
      - $ref: '#/components/schemas/ProcessesParams'
    ErrorSchema_error:
      properties:
        message:
          type: string
        status_code:
          minimum: 400
          type: integer
      required:
      - message
      - status_code
      type: object
    MigrationCleanupResult_error:
      properties:
        message:
          type: string
        status_code:
          type: integer
      required:
      - message
      - status_code
      type: object
    ProcessesParams_config:
      properties:
        field:
          description: Field to use instead of process.pid
          type: string
        overwrite:
          default: true
          description: Whether to overwrite field with process.pid
          type: boolean
      required:
      - field
      type: object
    RiskScoreMapping_inner:
      properties:
        field:
          type: string
        operator:
          enum:
          - equals
          type: string
        risk_score:
          description: Risk score (0 to 100)
          maximum: 100
          minimum: 0
          type: integer
        value:
          type: string
      required:
      - field
      - operator
      - value
      type: object
    RuleExecutionSummary_last_execution:
      properties:
        date:
          description: Date of the last execution
          format: date-time
          type: string
        message:
          type: string
        metrics:
          $ref: '#/components/schemas/RuleExecutionMetrics'
        status:
          $ref: '#/components/schemas/RuleExecutionStatus'
        status_order:
          type: integer
      required:
      - date
      - message
      - metrics
      - status
      - status_order
      type: object
    SeverityMapping_inner:
      properties:
        field:
          type: string
        operator:
          enum:
          - equals
          type: string
        severity:
          $ref: '#/components/schemas/Severity'
        value:
          type: string
      required:
      - field
      - operator
      - severity
      - value
      type: object
    ThreatMapping_inner_entries_inner:
      properties:
        field:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
        type:
          enum:
          - mapping
          type: string
        value:
          description: A string that is not empty and does not contain only whitespace
          minLength: 1
          pattern: ^(?! *$).+$
          type: string
      required:
      - field
      - type
      - value
      type: object
    ThreatMapping_inner:
      properties:
        entries:
          items:
            $ref: '#/components/schemas/ThreatMapping_inner_entries_inner'
          type: array
      required:
      - entries
      type: object
    ThresholdCardinality_inner:
      properties:
        field:
          type: string
        value:
          minimum: 0
          type: integer
      required:
      - field
      - value
      type: object
  securitySchemes:
    basicAuth:
      scheme: basic
      type: http
    apiKeyAuth:
      description: "e.g. Authorization: ApiKey base64AccessApiKey"
      in: header
      name: Authorization
      type: apiKey
